<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1e1e1e">
    <title>AI Text Editor</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="logo.svg" type="image/svg+xml">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <a href="/" class="logo-link" title="AI Editor">
                    <img src="logo.svg" alt="AI Editor" class="logo-image">
                </a>
                <div class="tabs" id="tabs"></div>
            </div>
            <div class="header-right">
                <button id="newTabBtn" class="icon-btn" title="New Tab (Cmd+T)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 5v14m-7-7h14"></path>
                    </svg>
                </button>
                <button id="openFileBtn" class="icon-btn" title="Open File (Cmd+O)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                </button>
                <button id="saveFileBtn" class="icon-btn" title="Save File (Cmd+S)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                </button>
                <button id="aiEditBtn" class="icon-btn" title="AI Edit Mode (Cmd+E)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 20h9"></path>
                        <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                    </svg>
                </button>
                <button id="commandPaletteBtn" class="icon-btn" title="Command Palette (Cmd+P)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </button>
                <button id="aiChatBtn" class="icon-btn" title="AI Chat (Cmd+K)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                </button>
                <button id="settingsBtn" class="icon-btn" title="Settings">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6"></path>
                        <path d="M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24"></path>
                        <path d="M1 12h6m6 0h6"></path>
                        <path d="M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path>
                    </svg>
                </button>
                <button id="themeToggle" class="icon-btn" title="Toggle Theme">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Editor Area -->
            <div id="editorArea" class="editor-area">
                <!-- Left Panel: Monaco Editor -->
                <div id="editorContainer" class="editor-container"></div>
                
                <!-- Right Panel: Smart Panel -->
                <div id="smartPanel" class="smart-panel">
                    <div class="smart-panel-header">
                        <div class="smart-panel-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                                <path d="M2 17l10 5 10-5"></path>
                                <path d="M2 12l10 5 10-5"></path>
                            </svg>
                            Smart Panel
                        </div>
                        <button id="toggleSmartPanel" class="icon-btn" title="Toggle Smart Panel">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                    </div>
                    <div id="smartPanelContent" class="smart-panel-content">
                        <div class="smart-panel-empty">Start typing to see smart suggestions...</div>
                    </div>
                </div>
                
                <!-- AI Edit Panel (Modal Mode) -->
                <div id="aiEditPanel" class="ai-edit-panel hidden">
                    <div class="ai-edit-header">
                        <div class="ai-edit-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="19" cy="12" r="1"></circle>
                                <circle cx="5" cy="12" r="1"></circle>
                            </svg>
                            AI Enhanced Version
                        </div>
                        <div class="ai-edit-actions">
                            <button id="aiEditAcceptBtn" class="action-btn accept-btn" title="Accept AI Changes (Cmd+Shift+A)">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                                Accept
                            </button>
                            <button id="aiEditRejectBtn" class="action-btn reject-btn" title="Reject Changes (Cmd+Shift+R)">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                                Reject
                            </button>
                            <button id="aiEditRefreshBtn" class="action-btn refresh-btn" title="Regenerate (Cmd+Shift+G)">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="23 4 23 10 17 10"></polyline>
                                    <polyline points="1 20 1 14 7 14"></polyline>
                                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                                </svg>
                                Regenerate
                            </button>
                        </div>
                    </div>
                    <div id="aiEditContainer" class="editor-container"></div>
                    <div class="ai-edit-prompt">
                        <input type="text" id="aiEditPromptInput" placeholder="Describe how you want to improve this code... (Enter to apply)">
                    </div>
                </div>
            </div>

            <!-- AI Chat Sidebar -->
            <div id="aiChatSidebar" class="ai-chat-sidebar hidden">
                <div class="chat-header">
                    <h3>AI Assistant</h3>
                    <button id="closeChatBtn" class="close-btn">✕</button>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div class="chat-input-container">
                    <textarea id="chatInput" placeholder="Ask AI anything... (Shift+Enter to send)" rows="3"></textarea>
                    <button id="sendChatBtn" class="send-btn">Send</button>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button id="closeSettingsBtn" class="close-btn">✕</button>
                </div>
                <div class="modal-body">
                    <div class="setting-group">
                        <label for="apiKeyInput">OpenAI API Key</label>
                        <input type="password" id="apiKeyInput" placeholder="sk-...">
                        <small>Your API key is stored locally and never sent anywhere except OpenAI.</small>
                    </div>
                    <div class="setting-group">
                        <label for="modelSelect">Model</label>
                        <select id="modelSelect">
                            <option value="gpt-4o">GPT-4o (Most Capable)</option>
                            <option value="gpt-4o-mini" selected>GPT-4o Mini (Fast & Balanced)</option>
                            <option value="gpt-4-turbo">GPT-4 Turbo (Very Capable)</option>
                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Fastest)</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label for="fontSizeInput">Font Size</label>
                        <input type="number" id="fontSizeInput" value="14" min="10" max="24">
                    </div>
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enableSmartPanel" checked>
                            Enable Smart Panel
                        </label>
                        <small>AI-powered analysis, corrections, and suggestions in the right panel</small>
                    </div>
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enableAutocomplete" checked>
                            Enable Fast Autocomplete
                        </label>
                        <small>Quick AI suggestions as you type</small>
                    </div>
                    <div class="setting-group">
                        <label for="autocompleteModel">Autocomplete Model</label>
                        <select id="autocompleteModel">
                            <option value="gpt-3.5-turbo" selected>GPT-3.5 Turbo (Fastest)</option>
                            <option value="gpt-4o-mini">GPT-4o Mini (Balanced)</option>
                        </select>
                        <small>Use faster models for real-time autocomplete</small>
                    </div>
                    <div class="setting-group">
                        <label for="correctionPrompt">Writing Correction Prompt</label>
                        <textarea id="correctionPrompt" rows="3" placeholder="Enter your custom correction instructions...">Improve grammar, clarity, and style. Fix typos and suggest better phrasing.</textarea>
                        <small>Define how the AI should correct and improve your writing</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="saveSettingsBtn" class="primary-btn">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Command Palette -->
        <div id="commandPalette" class="modal hidden">
            <div class="command-palette-content">
                <input type="text" id="commandInput" placeholder="Type a command...">
                <div id="commandList" class="command-list"></div>
            </div>
        </div>

        <!-- Autocomplete Suggestions -->
        <div id="autocompleteSuggestions" class="autocomplete-suggestions hidden"></div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left">
                <span id="fileStatus">Ready</span>
            </div>
            <div class="status-right">
                <span id="cursorPosition">Ln 1, Col 1</span>
                <span id="language">plaintext</span>
            </div>
        </div>
    </div>

    <!-- Monaco Editor -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
    
    <!-- App Scripts -->
    <script type="module" src="app.js"></script>
</body>
</html>

